import W from"./UploadFileFirebase-BovvWQpj.js";import D from"./EditableColor-CtBrJZe_.js";import j from"./EditableField-C2EuHdGr.js";import{r as $,a5 as J,a6 as Y,a7 as K,a8 as q,a9 as L,B as H,c as m,a as i,d as o,a1 as V,t as x,b as S,aa as X,ab as Z,C as z,f as P,m as ee,u as y,F as Q,I as te,ac as oe,p as O,S as B,l as _,G as w,e as U,Q as ae,i as se,J as le}from"./scoreboard-BHT3jrlv.js";import{_ as re}from"./_plugin-vue_export-helper-C8tdCacw.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},s=new e.Error().stack;s&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[s]="da33b8bc-55cc-43ba-967b-8187e6bbef79",e._sentryDebugIdIdentifier="sentry-dbid-da33b8bc-55cc-43ba-967b-8187e6bbef79")}catch{}})();const E=["name","record","color1","color2","textcolor","bgcolor","timeout_color","img"],N=$(!1),k=$([]);function R(e){const s=$(!1),p=$(""),d=t=>!t||!t.data?{}:{name:t.team_name,...t.data},f=async(t="")=>{s.value=!0;try{const l=await K(e,t);k.value=l.sports_teams||[]}catch(l){console.error("Failed to load teams:",l),k.value=[]}finally{s.value=!1}};let h=null;return{teams:k,loading:s,searchQuery:p,setupFields:E,fetchSportsTeams:f,searchSportsTeams:t=>{p.value=t,h&&clearTimeout(h),h=setTimeout(async()=>{await f(t.trim())},300)},saveSportsTeam:async t=>{s.value=!0;try{const l=await Y(t);return k.value.unshift(l.sports_team),l}catch(l){throw console.error("Failed to save team:",l),l}finally{s.value=!1}},removeSportsTeam:async t=>{s.value=!0;try{return await J(t),k.value=k.value.filter(l=>l.id!==t),!0}catch(l){throw console.error("Failed to delete team:",l),l}finally{s.value=!1}},getSportsTeamData:d,createSportsTeamData:(t,l)=>{const C={};return E.forEach(T=>{typeof t[T]<"u"&&(C[T]=t[T])}),{sport:l,team_name:t.name,data:C}},initialize:async()=>{N.value||(await f(),N.value=!0)}}}const ne={class:"modal-dialog modal-dialog-centered modal-lg"},ie={class:"modal-content"},de={class:"modal-header"},ce={class:"modal-title"},ue={class:"modal-body"},me={__name:"BsModal",props:q({title:{type:String,default:"",required:!1}},{open:{required:!0,type:Boolean},openModifiers:{}}),emits:q(["shown","hide"],["update:open"]),setup(e,{emit:s}){const p=L(e,"open"),d=s,f=$(null);function h(){window.bootstrap.Modal.getOrCreateInstance(f.value).show()}function c(){window.bootstrap.Modal.getOrCreateInstance(f.value).hide(),p.value=!1}H(p,n=>{n?h():c()});const b=()=>{z(()=>{d("visible")})},v=()=>{z(()=>{d("hidden")})};return(n,a)=>(i(),m("div",X({id:"bsModal",ref_key:"bsModal",ref:f,class:"modal",tabindex:"-1"},Z({"shown.bs.modal":b,"hidden.bs.modal":v,"hide.bs.modal":()=>p.value=!1})),[o("div",ne,[o("div",ie,[V(n.$slots,"header",{},()=>[o("div",de,[o("h5",ce,x(e.title),1),o("button",{"aria-label":"Close",class:"btn-close","data-testid":"close_modal",onClick:c,type:"button"})])]),o("div",ue,[p.value?V(n.$slots,"body",{key:0}):S("",!0)])])])],16))}},fe={class:"sports-teams-modal-content d-flex flex-column",style:{height:"70vh"}},pe={class:"mb-3 flex-shrink-0"},be={class:"position-relative"},ve=["value"],ge=["disabled"],ye={class:"flex-grow-1 overflow-auto"},he={key:0,class:"text-center py-4"},Te={key:1,class:"teams-list","data-testid":"sport-team-item-list"},we=["data-testid","onClick"],xe={class:"d-flex align-items-center p-3"},Se={class:"team-image-container-list me-3 flex-shrink-0"},$e=["src","alt"],Ce={key:1,class:"team-image-placeholder-list d-flex align-items-center justify-content-center"},ke={class:"flex-grow-1 pe-3"},_e={class:"fw-bold"},Be={key:0,class:"text-muted small"},Fe={class:"d-flex gap-2 mt-1"},De=["onClick","disabled"],qe={key:2,class:"text-center py-5 text-muted"},Me={class:"h5"},Ie={key:0},Ve={__name:"SetupSportsTeamsModal",props:q({sport:{type:String,required:!0},team:{type:String,required:!0},defaultTextColor:{type:String,required:!0},defaultBgColor:{type:String,required:!0}},{open:{type:Boolean},openModifiers:{}}),emits:q(["team-selected"],["update:open"]),setup(e,{emit:s}){const p=e,d=$(null),f=L(e,"open"),h=s,{teams:c,loading:b,searchQuery:v,searchSportsTeams:n,getSportsTeamData:a,removeSportsTeam:t,initialize:l}=R(p.sport);H(f,async g=>{g&&(v.value="",await l())});const C=g=>{const r=g.target.value;n(r)},T=()=>{v.value="",n("")},M=()=>{d.value.focus()},A=async g=>{const r=a(g);r&&(h("team-selected",{team:g,teamData:r}),B.fire({text:`Team "${g.team_name}" loaded successfully!`,icon:"success",toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,showClass:{popup:""},hideClass:{popup:""}}),f.value=!1)},G=async(g,r)=>{if(r.stopPropagation(),(await B.fire({title:"Delete Team?",text:`Are you sure you want to delete "${g.team_name}"? This action cannot be undone.`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!",cancelButtonText:"Cancel"})).isConfirmed)try{await t(g.id),B.fire({text:`Team "${g.team_name}" deleted successfully!`,icon:"success",toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,showClass:{popup:""},hideClass:{popup:""}})}catch{B.fire({text:"Failed to delete team. Please try again.",icon:"error",toast:!0,position:"top-end",showConfirmButton:!1,timer:4e3,timerProgressBar:!0,showClass:{popup:""},hideClass:{popup:""}})}};return(g,r)=>(i(),P(me,{open:f.value,"onUpdate:open":r[1]||(r[1]=u=>f.value=u),title:"My Sports Teams",size:"lg",onVisible:M,id:`sports-teams-modal-${e.team}`},{body:ee(()=>[o("div",fe,[o("div",pe,[o("div",be,[o("input",{type:"text",class:"form-control pe-5",placeholder:"Search teams...",value:y(v),onInput:C,ref_key:"searchInput",ref:d},null,40,ve),y(v)?(i(),m("button",{key:0,onClick:T,class:"btn btn-link position-absolute top-50 end-0 translate-middle-y pe-3",style:{"z-index":"10",color:"#6c757d"},title:"Clear search",disabled:y(b)},r[2]||(r[2]=[o("i",{class:"bi bi-x-circle-fill"},null,-1)]),8,ge)):S("",!0)])]),o("div",ye,[y(b)?(i(),m("div",he,r[3]||(r[3]=[o("div",{class:"spinner-border text-primary",role:"status"},[o("span",{class:"visually-hidden"},"Loading...")],-1),o("div",{class:"mt-2"},"Loading teams...",-1)]))):y(c).length>0?(i(),m("div",Te,[(i(!0),m(Q,null,te(y(c),u=>{var I;return i(),m("div",{key:u.id,class:"team-item border rounded cursor-pointer hover-highlight mb-2","data-testid":"sport-team-item-"+u.id,onClick:F=>A(u)},[o("div",xe,[o("div",Se,[(I=u.data)!=null&&I.img?(i(),m("img",{key:0,src:u.data.img,alt:u.team_name,class:"team-image-list",loading:"lazy",onError:r[0]||(r[0]=F=>F.target.style.display="none")},null,40,$e)):(i(),m("div",Ce,r[4]||(r[4]=[o("i",{class:"bi bi-image text-muted"},null,-1)])))]),o("div",ke,[o("div",_e,x(u.team_name),1),u.creation_date?(i(),m("div",Be," Created: "+x(y(oe)(u.creation_date)),1)):S("",!0),o("div",Fe,[o("i",{class:"rounded-circle border border-secondary d-inline-block",style:O({backgroundColor:u.data.color1||u.data.bgcolor||e.defaultBgColor,width:"20px",height:"20px"})},null,4),o("i",{class:"rounded-circle border border-secondary d-inline-block",style:O({backgroundColor:u.data.color2||u.data.textcolor||e.defaultTextColor,width:"20px",height:"20px"})},null,4)])]),o("button",{class:"btn btn-sm btn-outline-danger flex-shrink-0",onClick:F=>G(u,F),disabled:y(b),title:"Delete team"},r[5]||(r[5]=[o("i",{class:"bi bi-trash"},null,-1)]),8,De)])],8,we)}),128))])):(i(),m("div",qe,[r[6]||(r[6]=o("i",{class:"bi bi-inbox d-block mb-3",style:{"font-size":"3rem"}},null,-1)),o("div",Me,x(y(v)?"No teams found":"No saved teams yet"),1),y(v)?S("",!0):(i(),m("small",Ie,"Save your first team to get started!"))]))])])]),_:1},8,["open","id"]))}},Pe=re(Ve,[["__scopeId","data-v-5c76fde2"]]),Ue={class:"mb-0 mt-3","data-testid":"setup-sports-teams"},je={class:"row g-2 mb-3"},ze={class:"col-md-6"},Oe=["disabled","data-testid"],Ee={class:"col-md-6"},Ne=["data-testid"],Le={__name:"SetupSportsTeams",props:{team:{type:String,required:!0,validator:e=>["home","away"].includes(e)},score_data:{type:Object,required:!0},scoreboard_ref:{type:Object,required:!0},sport:{type:String,required:!0},defaultTextColor:{type:String,required:!0},defaultBgColor:{type:String,required:!0}},setup(e){const s=e,{loading:p,saveSportsTeam:d,createSportsTeamData:f,setupFields:h}=R(s.sport),c=$(!1),b=_(()=>(s.score_data[s.team].name||"").trim()),v=async({teamData:a})=>{const t=s.score_data[s.team],l={};h.forEach(T=>{typeof t[T]<"u"&&(l[T]=null)}),Object.assign(l,a);const C=Object.entries(l).map(([T,M])=>[`${s.team}.${T}`,"set",M]);await ae(C,s)},n=async()=>{if(b.value)try{const a=s.score_data[s.team],t=f(a,s.sport);t.team_name=b.value,await d(t),B.fire({text:`Team "${t.team_name}" created successfully!`,icon:"success",toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0})}catch(a){console.error("Failed to save team:",a),B.fire({text:"Failed to save team. Please try again.",icon:"error",toast:!0,position:"top-end",showConfirmButton:!1,timer:4e3,timerProgressBar:!0})}};return(a,t)=>(i(),m("div",Ue,[o("div",je,[o("div",ze,[o("button",{onClick:n,class:"btn btn-light btn-sm w-100",disabled:y(p)||!b.value,"data-testid":`sports-teams-save-${e.team}-btn`},[t[2]||(t[2]=o("i",{class:"bi bi-save"},null,-1)),U(" "+x(b.value?"Save current team":"Enter a team name first"),1)],8,Oe)]),o("div",Ee,[o("button",{class:"btn btn-sm btn-light w-100",onClick:t[0]||(t[0]=l=>c.value=!0),"data-testid":`sports-teams-browse-${e.team}-btn`},t[3]||(t[3]=[o("i",{class:"bi bi-collection"},null,-1),U(" Browse saved teams ")]),8,Ne)])]),w(Pe,{open:c.value,"onUpdate:open":t[1]||(t[1]=l=>c.value=l),onTeamSelected:v,sport:e.sport,team:e.team,"default-text-color":e.defaultTextColor,"default-bg-color":e.defaultBgColor},null,8,["open","sport","team","default-text-color","default-bg-color"])]))}},He=["data-testid"],Qe={class:"card-header d-flex justify-content-between align-items-center",style:{"min-height":"50px"}},Re={class:"card-body"},Ae={key:1,class:"row g-3 mt-2"},Ge={class:"col-md-6"},We=["for"],Je={class:"col-md-6"},Ye=["for"],Ke={key:2,class:"row g-3 mt-2"},Xe={class:"col-md-6"},Ze=["for"],et={class:"col-md-6"},tt=["for"],ot={class:"mb-0"},it={__name:"SetupTeamCard",props:{team:{type:String,required:!0,validator:e=>["home","away"].includes(e)},score_data:{type:Object,required:!0},scoreboard_ref:{type:Object,required:!0},useColorField:{type:Boolean,default:!1},canFlipTeams:Boolean,defaultTextColor:{type:String,default:"#FFFFFFFF"},defaultBgColor:{type:String,default:"#0048E8"},logo:{type:String,required:!0},title:String,sport:{type:String,required:!0}},emits:["flip-teams"],setup(e){const s=e,p=se("config"),d=(n,a)=>{le(`${s.team}.${n}`,"set",a,s)},f=_(()=>s.title||s.team==="home"?"Home team":"Away team"),h=_(()=>{var n;return(n=s.score_data.board)==null?void 0:n.show_team_records}),c=_(()=>s.score_data[s.team]),b=_(()=>{if(s.score_data[s.team].img){const n=s.score_data[s.team].img;return new URL(n.replace(/%2F/g,"/")).pathname.split("/").slice(-2,-1)[0]}return null}),v=_(()=>s.sport==="WRESTLING"?"Team/Wrestler logo:":"Team logo:");return(n,a)=>(i(),m("div",{class:"card text-bg-dark","data-testid":"setup-team-card-"+e.team},[o("div",Qe,[o("span",null,x(f.value),1),e.canFlipTeams?(i(),m("button",{key:0,class:"btn btn-light btn-sm",onClick:a[0]||(a[0]=t=>n.$emit("flip-teams"))},a[9]||(a[9]=[o("i",{class:"bi bi-arrow-left-right"},null,-1),U(" Flip home/away ")]))):S("",!0)]),o("div",Re,[w(j,{value:c.value.name,"component-id":`${e.team}-name`,onUpdateValue:a[1]||(a[1]=t=>d("name",t))},null,8,["value","component-id"]),h.value?(i(),m(Q,{key:0},[a[10]||(a[10]=o("label",{class:"form-label mb-0 mt-3",for:"home-record"},"Team record/ranking:",-1)),w(j,{value:c.value.record,"component-id":`${e.team}-record`,onUpdateValue:a[2]||(a[2]=t=>d("record",t))},null,8,["value","component-id"])],64)):S("",!0),e.useColorField?(i(),m("div",Ae,[o("div",Ge,[o("label",{class:"form-label mb-1",for:`${e.team}-color1`},"Background color:",8,We),w(D,{value:c.value.color1||e.defaultBgColor,"component-id":`${e.team}-color1`,onUpdateValue:a[3]||(a[3]=t=>d("color1",t))},null,8,["value","component-id"])]),o("div",Je,[o("label",{class:"form-label mb-1",for:`${e.team}-color2`},"Text color:",8,Ye),w(D,{value:c.value.color2||e.defaultTextColor,"component-id":`${e.team}-color2`,onUpdateValue:a[4]||(a[4]=t=>d("color2",t))},null,8,["value","component-id"])])])):(i(),m("div",Ke,[o("div",Xe,[o("label",{class:"form-label mb-1",for:`${e.team}-bgcolor`},"Background color:",8,Ze),w(D,{value:c.value.bgcolor||e.defaultBgColor,"component-id":`${e.team}-bgcolor`,onUpdateValue:a[5]||(a[5]=t=>d("bgcolor",t))},null,8,["value","component-id"])]),o("div",et,[o("label",{class:"form-label mb-1",for:`${e.team}-textcolor`},"Text color:",8,tt),w(D,{value:c.value.textcolor||e.defaultTextColor,"component-id":`${e.team}-textcolor`,onUpdateValue:a[6]||(a[6]=t=>d("textcolor",t))},null,8,["value","component-id"])])])),V(n.$slots,"extra-bottom-fields",{team:e.team,updateData:d}),a[11]||(a[11]=o("div",{class:"mt-3"},null,-1)),o("div",ot,x(v.value),1),(i(),P(W,{key:e.logo,"component-id":`${e.team}-logo`,filename:e.logo,"board-folder":b.value,onFileDeleted:a[7]||(a[7]=t=>d("img","")),onFileUploaded:a[8]||(a[8]=t=>d("img",t))},null,8,["component-id","filename","board-folder"])),y(p).is_user_logged_in?(i(),P(Le,{key:3,team:e.team,score_data:e.score_data,scoreboard_ref:e.scoreboard_ref,sport:e.sport,defaultTextColor:e.defaultTextColor,defaultBgColor:e.defaultBgColor},null,8,["team","score_data","scoreboard_ref","sport","defaultTextColor","defaultBgColor"])):S("",!0),a[12]||(a[12]=o("div",{class:"mt-3"},null,-1))])],8,He))}};export{it as _};
//# sourceMappingURL=SetupTeamCard-Ch3B2wMO.js.map
